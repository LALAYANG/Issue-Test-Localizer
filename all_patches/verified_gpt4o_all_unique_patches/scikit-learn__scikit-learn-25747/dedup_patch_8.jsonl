{"model_name_or_path": "agentless", "instance_id": "scikit-learn__scikit-learn-25747", "model_patch": "diff --git a/sklearn/utils/_set_output.py b/sklearn/utils/_set_output.py\nindex 386f312..8071b35 100644\n--- a/sklearn/utils/_set_output.py\n+++ b/sklearn/utils/_set_output.py\n@@ -18,6 +18,10 @@ def _wrap_in_pandas_container(data_to_wrap, *, columns, index=None):\n         if index is not None:\n             data_to_wrap.index = index\n         return data_to_wrap\n+    if columns is not None and len(columns) != data_to_wrap.shape[1]:\n+        raise ValueError('Length mismatch: columns have {} elements, data_to_wrap has {} columns'.format(len(columns), data_to_wrap.shape[1]))\n+    if index is not None and len(index) != data_to_wrap.shape[0]:\n+        raise ValueError('Length mismatch: index has {} elements, data_to_wrap has {} rows'.format(len(index), data_to_wrap.shape[0]))\n     return pd.DataFrame(data_to_wrap, index=index, columns=columns)\n def _get_output_config(method, estimator=None):\n     est_sklearn_output_config = getattr(estimator, '_sklearn_output_config', {})"}
