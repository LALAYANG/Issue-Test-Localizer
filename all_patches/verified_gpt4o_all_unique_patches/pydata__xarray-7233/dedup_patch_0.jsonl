{"model_name_or_path": "agentless", "instance_id": "pydata__xarray-7233", "model_patch": "diff --git a/xarray/core/dataset.py b/xarray/core/dataset.py\nindex c0dd828..4bbbcc7 100644\n--- a/xarray/core/dataset.py\n+++ b/xarray/core/dataset.py\n@@ -1029,8 +1029,10 @@ class Dataset(\n     ) -> T_Dataset:\n         \"\"\"Replace variables with recalculated dimensions.\"\"\"\n         dims = calculate_dimensions(variables)\n+        # Ensure non-dimensional coordinates remain as coordinates\n+        new_coord_names = coord_names if coord_names is not None else self._coord_names\n         return self._replace(\n-            variables, coord_names, dims, attrs, indexes, inplace=inplace\n+            variables, new_coord_names, dims, attrs, indexes, inplace=inplace\n         )\n \n     def _replace_vars_and_dims(\n"}
