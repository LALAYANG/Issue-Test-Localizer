{"model_name_or_path": "agentless", "instance_id": "pydata__xarray-7393", "model_patch": "diff --git a/xarray/core/indexes.py b/xarray/core/indexes.py\nindex d49b2c1..88bcd82 100644\n--- a/xarray/core/indexes.py\n+++ b/xarray/core/indexes.py\n@@ -708,6 +708,7 @@ class PandasMultiIndex(PandasIndex):\n \n         split_labels, levels = zip(*[lev.factorize() for lev in level_indexes])\n         labels_mesh = np.meshgrid(*split_labels, indexing=\"ij\")\n+        labels = [np.asarray(x.ravel(), dtype=label_idx.dtype) for x, label_idx in zip(labels_mesh, split_labels)]\n         labels = [x.ravel() for x in labels_mesh]\n \n         index = pd.MultiIndex(levels, labels, sortorder=0, names=variables.keys())\n"}
