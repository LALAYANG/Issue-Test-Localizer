{"model_name_or_path": "agentless", "instance_id": "pydata__xarray-7393", "model_patch": "diff --git a/xarray/core/indexes.py b/xarray/core/indexes.py\nindex d49b2c1..2e2c808 100644\n--- a/xarray/core/indexes.py\n+++ b/xarray/core/indexes.py\n@@ -706,7 +706,9 @@ class PandasMultiIndex(PandasIndex):\n                     f\"from variable {name!r} that wraps a multi-index\"\n                 )\n \n-        split_labels, levels = zip(*[lev.factorize() for lev in level_indexes])\n+        split_labels, levels = zip(*[(lev.factorize(sort=False)) for lev in level_indexes])\n+        levels = [level.astype(variables[k].dtype) if np.issubdtype(level.dtype, np.integer) else level \n+                  for k, level in zip(variables.keys(), levels)]\n         labels_mesh = np.meshgrid(*split_labels, indexing=\"ij\")\n         labels = [x.ravel() for x in labels_mesh]\n \n", "occurrence": 1}
